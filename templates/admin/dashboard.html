<!-- Add this in the appropriate section of your admin dashboard --><div class="card mb-4">
    <div class="card-header">
        <h5 class="mb-0">Attendance Management</h5>
    </div>
    <div class="card-body">
        <button id="syncButton" class="btn btn-primary" onclick="triggerSync()">
            <i class="fas fa-sync-alt"></i> Sync Attendance Now
        </button>
        <div id="syncStatus" class="mt-2"></div>
    </div>
</div>

<script>
function triggerSync() {
    const button = document.getElementById('syncButton');
    const status = document.getElementById('syncStatus');
    
    // Disable button and show loading state
    button.disabled = true;
    button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Syncing...';
    status.innerHTML = '';
    
    // Make the API call
    fetch('/attendance/manual-sync', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        credentials: 'same-origin'
    })
    .then(response => response.json())
    .then(data => {
        if (data.status === 'success') {
            let message = 'âœ… ' + data.message;
            if (data.records_added !== undefined || data.records_updated !== undefined) {
                message += '<br><small>';
                if (data.records_added > 0) {
                    message += `ğŸ“¥ <strong>${data.records_added}</strong> new records added`;
                }
                if (data.records_updated > 0) {
                    if (data.records_added > 0) message += ' | ';
                    message += `ğŸ”„ <strong>${data.records_updated}</strong> records updated`;
                }
                if (data.records_added === 0 && data.records_updated === 0) {
                    message += 'No new data found';
                }
                message += '</small>';
            }
            status.innerHTML = '<div class="alert alert-success">' + message + '</div>';
        } else {
            status.innerHTML = '<div class="alert alert-danger">âŒ ' + data.message + '</div>';
        }
    })
    .catch(error => {
        status.innerHTML = '<div class="alert alert-danger">âŒ Error: ' + error.message + '</div>';
    })
    .finally(() => {
        // Reset button state
        button.disabled = false;
        button.innerHTML = '<i class="fas fa-sync-alt"></i> Sync Attendance Now';
        
        // Refresh the page after 2 seconds to show updated data
        setTimeout(() => {
            location.reload();
        }, 2000);
    });
}
</script>
